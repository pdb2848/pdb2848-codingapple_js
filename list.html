<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

</head>

<body>

    <div class="container">
        <div class="row">

            <!-- <div class="col-sm-4">
                <img src="https://placehold.co/600" class="w-100">
                <h5>Card title</h5>
                <p>가격 : 70000</p>
            </div> -->

        </div>
    </div>

    <div class="container my-3">
        <button class="btn btn-danger" id="price">가격순정렬</button>
        <button class="btn btn-danger" id="title">상품명 내림정렬</button>
        <button class="btn btn-danger" id="under">6만원 이하 상품만 보기</button>
    </div>

    <div class="container">
        <button class="btn btn-danger" id="more">더보기</button>
    </div>



    <script>
        //서버 데이터 예시
        var products = [
            { id: 0, price: 70000, title: 'Blossom Dress' },
            { id: 1, price: 50000, title: 'Springfield Shirt' },
            { id: 2, price: 60000, title: 'Black Monastery' }
        ];

        //서버 데이터 가져온 후 html로 보여주기
        inputData(products)

        //더보기 버튼 누른 횟수
        var count = 0
        //더보기 버튼
        $('#more').click(function () {
            count = count + 1
            if (count == 1) {
                $.get("https://codingapple1.github.io/js/more1.json").done(function (data) {
                    inputData(data)
                })
            }
            else if (count == 2){
                $.get("https://codingapple1.github.io/js/more2.json").done(function (data) {
                    inputData(data)
                })

                $('#more').hide()
            }

        })

        //서버 데이터 html로 보여주는 함수
        function inputData(arr) {
            arr.forEach(function (a) {
                var templete = `<div class="col-sm-4">
                        <img src="https://placehold.co/600" class="w-100">
                        <h5>${a['title']}</h5>
                        <p>가격 : ${a['price']}</p>
                        <button class="buy">구매</button>
                        </div>`

                $('.row').append(templete);
            })
        }

        //가격순정렬 
        $('#price').click(function(){
            products.sort(function(a, b){
                return a.price - b.price
            })

            $('.row').html('')

            inputData(products)
        })
        //상품명 내림 정렬
        $('#title').click(function(){
            products.sort(function(a, b){
                if (a.title < b.title){
                    return 1
                }
                else if (a.title > b.title){
                    return -1
                }
                else{
                    return 0
                }
            })

            $('.row').html('')

            inputData(products)
        })
        //6만원 이하만 보기
        $('#under').click(function(){
            var underArr = products.filter(function(a, b){
                return a.price <= 60000
            })

            $('.row').html('')

            inputData(underArr)
        })

        
        //구매버튼
        $('.buy').click(function(){
            // console.log($(this).siblings('h5').text())
            // console.log(localStorage.getItem('get')) 
            var arr 
            var jArr
            if (localStorage.getItem('cart') == null){
                arr = [$(this).siblings('h5').text()]
                jArr = JSON.stringify(arr)
                localStorage.setItem('cart', jArr)
            }
            else {
                jArr = localStorage.getItem('cart')
                arr = JSON.parse(jArr)
                arr.push($(this).siblings('h5').text())
                jArr = JSON.stringify(arr)
                localStorage.setItem('cart', jArr)
                // console.log(jArr)
            }
        })
        

    </script>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

</body>

</html>